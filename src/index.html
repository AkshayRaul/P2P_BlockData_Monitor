<!-- <!DOCTYPE HTML> -->
<html>
<head>



</head>
<body>

  <div id="sse">
    <h1>
      Websockets
    </h1>
    <div id="out"></div>

  </div>
  <div>
    Select a text file:
    <input type="file" id="input">
  </div>
  <input type="textarea" id="inp">
  <button onclick="SendMessage()">Send Message</button>
  <pre id="fileDisplayArea"></pre>
  <script type="text/javascript">
  // Let us open a web socket
  var ws = new WebSocket("wss://127.0.0.1:8080/Blockchain/ws/");

  var inputElement = document.getElementById("input");
  inputElement.addEventListener("change", handleFiles, false);
  function handleFiles() {
    console.log("File");
    var file = this.files[0]; /* now you can work with the file list */
    var fr = new FileReader();
    fr.addEventListener("loadend", function() {
      // send the file over web sockets
      ws.send(fr.result);
    });
    fr.readAsArrayBuffer(file)
  }

  ws.onopen = function(){
    // Web Socket is connected, send data using send()
      console.log("Message is sent...");

  };

  ws.onmessage = function (evt)
  {
    console.log(evt)
    document.getElementById("out").innerHTML=evt.data
  };

  ws.onclose = function()
  {
    // document.getElementById("out").innerHTML="Closed"
  };
  function SendMessage(){
    try{
      var json=JSON.stringify({
        "messageType":"metaData",
        "ipAddress":document.getElementById("inp").value,
        "storageSpace":"adasdaMB"
      })
      ws.send(json);
    }catch(e){
      console.log(e)
    }

  }
  </script>
</body>
</html>
